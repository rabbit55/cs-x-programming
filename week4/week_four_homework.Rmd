---
title: "week_four_practice"
author: "christine"
date: "2018年3月29日"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(httr)
library(rjson)
library(httpuv)
library(Rfacebook)
library(NLP)
library(tm)
library(jiebaRD)
library(jiebaR)
library(RColorBrewer)
library(wordcloud)
page.id <- "232716627404" 
token <- "EAACEdEose0cBAHdX2m1JxTAzCCkH6wkOw9z3kJTBGfhuo6tkA2dI0DoQ9EMe44b1dqxHYqWZCZCYeZADzUiCyE6DoUZAEeNC50batIFfbiJsLKfsq9ceNlnNgZA6rEtAR3wjNc8zRE1d3oEeh5TJqmidL8WWkjL9112EVdwR0vKxCTMmUP9R1iuFCOxKX1ZANl7cBzH0T1KQZDZD" 
page <- getPage(page.id, token, n = 300)
str(page)
docs <- Corpus(VectorSource(page$message))
toSpace <- content_transformer(function(x, pattern) {
  return (gsub(pattern, " ", x))}
)
```
It took me a while to find the token (I always forget easily).
Then I try to understand the code and start cleaning the words which don't possess real meanings.
```{r movie}
docs <- tm_map(docs, toSpace, "的")
docs <- tm_map(docs, toSpace, "啊")
docs <- tm_map(docs, toSpace, "有")
docs <- tm_map(docs, toSpace, "了")
docs <- tm_map(docs, toSpace, "是")
docs <- tm_map(docs, toSpace, "很")
docs <- tm_map(docs, toSpace, "都")
docs <- tm_map(docs, toSpace, "我")
docs <- tm_map(docs, removePunctuation)
docs <- tm_map(docs, removeNumbers)
docs <- tm_map(docs, stripWhitespace)
docs <- tm_map(docs, function(word) {gsub("[A-Za-z0-9]", "", word)})
```
and now cut the words...
```{r hardwork}
mixseg = worker()
jieba_tokenizer=function(d){
  unlist(segment(d[[1]],mixseg))
}
seg = lapply(docs, jieba_tokenizer)
freqFrame = as.data.frame(table(unlist(seg)))
```
put the text into dataframe and plot the wordcloud
```{r final}
freqFrame = freqFrame[-c(1:34),]
wordcloud(freqFrame$Var1,freqFrame$Freq,
          scale=c(3,0.5),min.freq=15,max.words=40,
          random.order=FALSE, random.color=TRUE, 
          rot.per=.1, colors=brewer.pal(8, "Dark2"),
          ordered.colors=FALSE,use.r.layout=FALSE,
          fixed.asp=TRUE)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
